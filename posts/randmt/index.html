<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="author" content="Pascal Getreuer" />
  <title>randmt: MT19937 pseudorandom number generator</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="../../site.css" type="text/css" />
<link rel="icon" href="../../favicon.ico" type="image/x-icon" />
<link href="https://fonts.googleapis.com/css?family=Noto+Serif+SC" rel="stylesheet" />
<script type="text/javascript" src="../../site.js" ></script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<div id="navbar">
<div id="navhold">
  <a href="../../index.html">Home</a>
  <a href="../../papers/index.html">Papers</a>
  <a href="../../posts/index.html">Posts</a>
</div>
</div>
<div id="content">
<div id="header">
<h1 class="title">randmt: MT19937 pseudorandom number generator</h1>
<h2 class="author">Pascal Getreuer</h2>
</div>
<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#warning">Warning</a></li>
<li><a href="#license">License</a></li>
<li><a href="#use">Use</a></li>
<li><a href="#reentrant-versions">Reentrant Versions</a></li>
<li><a href="#history">History</a></li>
<li><a href="#test-program">Test Program</a></li>
<li><a href="#function-reference">Function Reference</a><ul>
<li><a href="#init_randmt_auto">init_randmt_auto</a></li>
<li><a href="#init_randmt">init_randmt</a></li>
<li><a href="#rand_unif">rand_unif</a></li>
<li><a href="#rand_uint32">rand_uint32</a></li>
<li><a href="#rand_normal">rand_normal</a></li>
<li><a href="#rand_exp">rand_exp</a></li>
<li><a href="#rand_gamma">rand_gamma</a></li>
<li><a href="#rand_geometric">rand_geometric</a></li>
<li><a href="#rand_poisson">rand_poisson</a></li>
<li><a href="#new_randmt">new_randmt</a></li>
<li><a href="#free_randmt">free_randmt</a></li>
<li><a href="#init_randmt_auto_r">init_randmt_auto_r</a></li>
<li><a href="#init_randmt_r">init_randmt_r</a></li>
<li><a href="#rand_unif_r">rand_unif_r</a></li>
<li><a href="#rand_uint32_r">rand_uint32_r</a></li>
<li><a href="#rand_normal_r">rand_normal_r</a></li>
<li><a href="#rand_exp_r">rand_exp_r</a></li>
<li><a href="#rand_gamma_r">rand_gamma_r</a></li>
<li><a href="#rand_geometric_r">rand_geometric_r</a></li>
<li><a href="#rand_poisson_r">rand_poisson_r</a></li>
</ul></li>
</ul>
</div>
<div class="features">
<p><a href="randmt-20111011.zip">Download</a></p>
</div>
<div style="clear: both">
 
</div>
<h2 id="overview">Overview</h2>
<p>This C/C++ software contains a high-quality pseudorandom number generator, the Mersenne Twister MT19937 by Takuji Nishimura and Makoto Matsumoto, and routines for sampling from several distributions.</p>
<h2 id="warning">Warning</h2>
<p><strong>Do not use for cryptographic purposes.</strong> Read <a href="http://tools.ietf.org/html/rfc4086">Internet RFC4086</a>.</p>
<h2 id="license">License</h2>
<p>This software is distributed under the BSD license. See the included file license.txt for details.</p>
<h2 id="use">Use</h2>
<p>To use randmt in a program, only the files randmt.h and randmt.c are needed; all other included files are for documentation and testing purposes. Include randmt.h and call <code>init_randmt_auto()</code> at the beginning of the program to initialize the pseudorandom number generator. The initialization function seeds the generator with the current time so that different numbers are produced on each run of the program.</p>
<p>Uniform random numbers are generated using the <code>rand_unif()</code> function. Samples from several other distributions can be generated as well, see below.</p>
<p>Example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb1-1" title="1"><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="pp">#include </span><span class="im">&quot;randmt.h&quot;</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="dt">int</span> main(<span class="dt">void</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">{</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="dt">int</span> i;</a>
<a class="sourceLine" id="cb1-7" title="7">  init_randmt_auto();</a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">20</span>; ++i) {</a>
<a class="sourceLine" id="cb1-9" title="9">    printf(<span class="st">&quot;%10.8f</span><span class="sc">\n</span><span class="st">&quot;</span>, rand_unif());</a>
<a class="sourceLine" id="cb1-10" title="10">  }</a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="cf">return</span> <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-12" title="12">}</a></code></pre></div>
<p>This program can be compiled with GCC using the included makefile as</p>
<pre><code>make -f makefile.gcc example</code></pre>
<p>or with MSVC,</p>
<pre><code>nmake -f makefile.vc example.exe</code></pre>
<p>Pseudorandom numbers can be generated for several different distributions:</p>
<dl>
<dt><code>rand_unif()</code></dt>
<dd><p>continuous uniform distribution on the open interval (0,1)</p>
</dd>
<dt><code>rand_uint32()</code></dt>
<dd><p>32-bit unsigned integers uniformly in <span class="math inline">\(\{0,\ldots, 2^{31}-1\}\)</span></p>
</dd>
<dt><code>rand_normal()</code></dt>
<dd><p>the standard normal distribution (zero mean, unit variance)</p>
</dd>
<dt><code>rand_exp(mu)</code></dt>
<dd><p>exponential distribution with mean <code>mu</code></p>
</dd>
<dt><code>rand_gamma(a, b)</code></dt>
<dd><p>Gamma distribution with shape <code>a</code> and scale <code>b</code></p>
</dd>
<dt><code>rand_geometric(p)</code></dt>
<dd><p>geometric distribution</p>
</dd>
<dt><code>rand_poisson(mu)</code></dt>
<dd><p>Poisson distribution with mean <code>mu</code></p>
</dd>
</dl>
<h2 id="reentrant-versions">Reentrant Versions</h2>
<p>For use in multithreaded applications, reentrant versions of the functions are also included which have the same name suffixed with <code>_r</code>. With these functions the generator state is passed using a <code>randmt_t</code> object, for instance as <code>rand_unif_r(generator)</code> or <code>rand_exp_r(generator, mu)</code>.</p>
<p>A <code>randmt_t</code> object represents the state of an MT19937 pseudo-random number generator. Use the following functions to create, initialize, and destroy <code>randmt_t</code> objects:</p>
<dl>
<dt><code>new_randmt()</code></dt>
<dd><p>create a new <code>randmt_t</code></p>
</dd>
<dt><code>free_randmt(generator)</code></dt>
<dd><p>free memory associated with a <code>randmt_t</code></p>
</dd>
<dt><code>init_randmt_auto_r(generator)</code></dt>
<dd><p>initialize <code>randmt_t</code> with time and address</p>
</dd>
<dt><code>init_randmt_r(generator, seed)</code></dt>
<dd><p>initialize <code>randmt_t</code> with <code>seed</code></p>
</dd>
</dl>
<h2 id="history">History</h2>
<ul>
<li><p>This code uses <a href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html">the Mersenne Twister MT19937 code</a> by Makoto Matsumoto and Takuji Nishimura (2002/1/26).</p></li>
<li><p>Seiji Nishimura (2008) wrote <a href="http://www.k3.dion.ne.jp/~sn1976/site/Software.html">a reentrant modification of MT19937</a>, where a generator struct is passed to sampling functions.</p></li>
<li><p><a href="http://dev.ipol.im/git/?p=nil/mt.git;a=summary">Nicolas Limare wrote a version</a> with Doxygen documentation, simpler interface, and automatic initialization using the time.</p></li>
<li><p>In the code documented here, Pascal Getreuer added samplers for normal, exponential, Gamma, geometric, and Poisson distributions and a test program.</p></li>
</ul>
<h2 id="test-program">Test Program</h2>
<p>To verify the distributions of the samplers, a test program is included. Compile the test program using</p>
<pre><code>make -f makefile.gcc test</code></pre>
<p>or with MSVC,</p>
<pre><code>nmake -f makefile.vc test.exe</code></pre>
<p>The test program applies the Kolmogorov–Smirnov and chi-squared tests to verify that the pseudorandom samplers produce the intended distributions. Note that the output of this program is different on each run.</p>
<p>Typical output is shown below:</p>
<pre><code>For each random number generator, we sample N=1000000
values and compare the sample distribution to the theoretical
density function with the Kolmogorov-Smirnov test.

    Sampler              D
    rand_unif()          0.001095
    rand_normal()        0.001077
    rand_exp(1)          0.000811
    rand_gamma(0.2,1)    0.000516
    rand_gamma(  1,1)    0.000906
    rand_gamma(  2,1)    0.001051
    rand_gamma( 20,1)    0.001079

Supposing the distributions are correct, the D values should be
small with high probability:
    D &lt; 0.001358 with probability 0.95
    D &lt; 0.001627 with probability 0.99
    D &lt; 0.001949 with probability 0.999

We apply the chi-squared test to verify the distributions of the
geometric and Poisson generators (the Kolmogorov-Smirnov test
applies only to continuous distributions).

    Sampler              p-value
    rand_geometric(0.1)  0.883482
    rand_geometric(0.5)  0.527853
    rand_geometric(0.9)  0.651309
    rand_poisson(0.2)    0.700759
    rand_poisson(  1)    0.551421
    rand_poisson(  2)    0.619268
    rand_poisson( 20)    0.656092
    rand_poisson(200)    0.422257

Supposing the distributions are correct, the p-values should be
above zero with high probability:
    p-value &gt; 0.05 with probability 0.95
    p-value &gt; 0.01 with probability 0.99
    p-value &gt; 0.001 with probability 0.999</code></pre>
<h2 id="function-reference">Function Reference</h2>
<h3 id="init_randmt_auto">init_randmt_auto</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb7-1" title="1"><span class="dt">void</span> init_randmt_auto()</a></code></pre></div>
<p>seeds the global generator with the current time. It should be called once at the beginning of the program so that different pseudorandom values are produced on different runs.</p>
<p>It is enough to call this function once. Seeding multiple times does not improve statistical quality of the generator.</p>
<h3 id="init_randmt">init_randmt</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb8-1" title="1"><span class="dt">void</span> init_randmt(<span class="dt">unsigned</span> <span class="dt">long</span> seed)</a></code></pre></div>
<p>seeds the global random number generator with an unsigned 32-bit integer value.</p>
<p>A constant seed can be used to reproduce the same pseudorandom numbers.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb9-1" title="1"><span class="dt">int</span> i;</a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3">init_randmt(<span class="dv">42</span>);</a>
<a class="sourceLine" id="cb9-4" title="4">printf(<span class="st">&quot;Ten numbers:</span><span class="sc">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">10</span>; ++i) {</a>
<a class="sourceLine" id="cb9-6" title="6">  printf(<span class="st">&quot;%f</span><span class="sc">\n</span><span class="st">&quot;</span>, rand_unif());</a>
<a class="sourceLine" id="cb9-7" title="7">}</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">init_randmt(<span class="dv">42</span>);</a>
<a class="sourceLine" id="cb9-10" title="10">printf(<span class="st">&quot;The same ten numbers:</span><span class="sc">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb9-11" title="11"><span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">10</span>; +++i) {</a>
<a class="sourceLine" id="cb9-12" title="12">  printf(<span class="st">&quot;%f</span><span class="sc">\n</span><span class="st">&quot;</span>, rand_unif());</a>
<a class="sourceLine" id="cb9-13" title="13">}</a></code></pre></div>
<h3 id="rand_unif">rand_unif</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb10-1" title="1"><span class="dt">double</span> rand_unif()</a></code></pre></div>
<p>generates a random number uniformly on the open interval (0,1) with 53-bit resolution. The global generator is used to generate the value.</p>
<table style="width:46%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 30%" />
</colgroup>
<tbody>
<tr class="odd">
<td>CDF</td>
<td><div class="line-block"><span class="math inline">\(\min(\max(x,0),1)\)</span></div></td>
</tr>
<tr class="even">
<td>Mean</td>
<td>1/2</td>
</tr>
<tr class="odd">
<td>Variance</td>
<td>1/12</td>
</tr>
</tbody>
</table>
<h3 id="rand_uint32">rand_uint32</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb11-1" title="1"><span class="dt">unsigned</span> <span class="dt">long</span> rand_uint32()</a></code></pre></div>
<p>a random 32-bit unsigned integer uniformly between 0 and 0xFFFFFFFF. The global generator is used to generate the value.</p>
<h3 id="rand_normal">rand_normal</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb12-1" title="1"><span class="dt">double</span> rand_normal()</a></code></pre></div>
<p>generates a standard normal distributed random number with probability density</p>
<p><span class="math display">\[ f(x) = \tfrac{1}{\sqrt{2\pi}} \mathrm{e}^{-x^2 / 2}, \]</span></p>
<p>using the Box–Muller transform. The global generator is used to generate the value.</p>
<table style="width:94%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr class="odd">
<td>CDF</td>
<td><div class="line-block"><span class="math inline">\(\tfrac{1}{2}\bigl(1 + \mathrm{erf}(x/\sqrt{2})\bigr)\)</span></div></td>
</tr>
<tr class="even">
<td>Mean</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Variance</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="rand_exp">rand_exp</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb13-1" title="1"><span class="dt">double</span> rand_exp(<span class="dt">double</span> mu)</a></code></pre></div>
<p>generates an exponentially-distributed number with mean <code>mu</code> with probability density</p>
<p><span class="math display">\[ f(x;\mu) = \begin{cases}
\tfrac{1}{\mu} \mathrm{e}^{-x/mu} &amp; x \ge 0, \\
0 &amp; x &lt; 0,
\end{cases} \]</span></p>
<p>by inversion. The global generator is used to generate the value.</p>
<table style="width:44%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="odd">
<td>CDF</td>
<td><div class="line-block"><span class="math inline">\(1 - \exp(-x/\mu)\)</span></div></td>
</tr>
<tr class="even">
<td>Mean</td>
<td><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="odd">
<td>Variance</td>
<td><span class="math inline">\(\mu^2\)</span></td>
</tr>
</tbody>
</table>
<h3 id="rand_gamma">rand_gamma</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb14-1" title="1"><span class="dt">double</span> rand_gamma(<span class="dt">double</span> a, <span class="dt">double</span> b)</a></code></pre></div>
<p>generates a Gamma-distributed number with shape parameter <code>a</code> and scale parameter <code>b</code> with probability density</p>
<p><span class="math display">\[ f(x;a,b) = x^{a-1} \frac{\exp(-x/b)}{\Gamma(a)b^k}, \quad x \ge 0, \]</span></p>
<p>using the method of Marsaglia and Tsang, 2000. The global generator is used to generate the value.</p>
<table style="width:57%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 41%" />
</colgroup>
<tbody>
<tr class="odd">
<td>CDF</td>
<td><div class="line-block"><span class="math inline">\(\gamma(a,x/b) / \Gamma(a)\)</span></div></td>
</tr>
<tr class="even">
<td>Mean</td>
<td><span class="math inline">\(ab\)</span></td>
</tr>
<tr class="odd">
<td>Variance</td>
<td><span class="math inline">\(ab^2\)</span></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(\gamma\)</span> is the lower incomplete Gamma function.</p>
<h3 id="rand_geometric">rand_geometric</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb15-1" title="1"><span class="dt">double</span> rand_geometric(<span class="dt">double</span> p)</a></code></pre></div>
<p>generates a geometrically-distributed number where <code>p</code> is the probability of success with</p>
<p><span class="math display">\[ P(X = k) = (1 - p)^{k-1} p, \quad k = 1, 2, \ldots \]</span></p>
<p>The global generator is used to generate the value.</p>
<table style="width:65%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>CDF</td>
<td><div class="line-block"><span class="math inline">\(1 - (1 - p)^{\lfloor k \rfloor}\)</span></div></td>
</tr>
<tr class="even">
<td>Mean</td>
<td><span class="math inline">\(1/p\)</span></td>
</tr>
<tr class="odd">
<td>Variance</td>
<td><span class="math inline">\((1-p)/p^2\)</span></td>
</tr>
</tbody>
</table>
<h3 id="rand_poisson">rand_poisson</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb16-1" title="1"><span class="dt">double</span> rand_poisson(<span class="dt">double</span> mu)</a></code></pre></div>
<p>generates a Poisson-distributed number with mean <code>mu</code> with</p>
<p><span class="math display">\[ P(X = k) = \frac{\mu^k \mathrm{e}^{-\mu}}{k!}, \quad k = 0, 1, \ldots \]</span></p>
<p>using a simple direct algorithm for <code>mu &lt; 10</code> and the “PTRS” algorithm of Hormann for larger <code>mu</code>. The global generator is used to generate the value.</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 85%" />
</colgroup>
<tbody>
<tr class="odd">
<td>CDF</td>
<td><div class="line-block"><span class="math inline">\(1 - \gamma(\lfloor k + 1\rfloor, \mu) / \lfloor k\rfloor !\)</span></div></td>
</tr>
<tr class="even">
<td>Mean</td>
<td>μ</td>
</tr>
<tr class="odd">
<td>Variance</td>
<td>μ</td>
</tr>
</tbody>
</table>
<h3 id="new_randmt">new_randmt</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb17-1" title="1">randmt_t *new_randmt()</a></code></pre></div>
<p>creates a new <code>randmt_t</code>, or returns <code>NULL</code> on memory allocation failure. The newly-created <code>randmt_t</code> should be initialized using <code>init_randmt_auto_r</code> or <code>init_randmt_r</code>. After use, call <code>free_randmt</code> to free memory associated with the <code>randmt_t</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb18-1" title="1">randmt_t *generator = NULL;</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="dt">int</span> i;</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="cf">if</span> (!(generator = new_randmt())) {</a>
<a class="sourceLine" id="cb18-5" title="5">  exit(<span class="dv">1</span>);</a>
<a class="sourceLine" id="cb18-6" title="6">}</a>
<a class="sourceLine" id="cb18-7" title="7"></a>
<a class="sourceLine" id="cb18-8" title="8">init_randmt_auto_r(generator);</a>
<a class="sourceLine" id="cb18-9" title="9"></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">10</span>; ++i) {</a>
<a class="sourceLine" id="cb18-11" title="11">  printf(<span class="st">&quot;%f</span><span class="sc">\n</span><span class="st">&quot;</span>, rand_unif_r(generator));</a>
<a class="sourceLine" id="cb18-12" title="12">}</a>
<a class="sourceLine" id="cb18-13" title="13"></a>
<a class="sourceLine" id="cb18-14" title="14">free_randmt(generator);</a></code></pre></div>
<h3 id="free_randmt">free_randmt</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb19-1" title="1"><span class="dt">void</span> free_randmt(randmt_t *generator)</a></code></pre></div>
<p>frees the memory associated with <code>generator</code>.</p>
<h3 id="init_randmt_auto_r">init_randmt_auto_r</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb20-1" title="1"><span class="dt">void</span> init_randmt_auto_r(randmt_t *generator)</a></code></pre></div>
<p>initializes generator with the current time and memory address. The generator is seeded using the current time added to the memory address of the generator. The memory address is included so that different generators are initialized with different seeds. An array of generators can be created initialized as</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb21-1" title="1">randmt_t *generators[<span class="dv">16</span>];</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="dt">int</span> i;</a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">16</span>; ++i) {</a>
<a class="sourceLine" id="cb21-5" title="5">  <span class="cf">if</span>(!(generators[i] = new_randmt())) {</a>
<a class="sourceLine" id="cb21-6" title="6">    exit(<span class="dv">1</span>);</a>
<a class="sourceLine" id="cb21-7" title="7">  }</a>
<a class="sourceLine" id="cb21-8" title="8">}</a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">16</span>; i++) {</a>
<a class="sourceLine" id="cb21-11" title="11">  init_randmt_auto_r(generators[i]);</a>
<a class="sourceLine" id="cb21-12" title="12">}</a></code></pre></div>
<h3 id="init_randmt_r">init_randmt_r</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb22-1" title="1"><span class="dt">void</span> init_randmt_r(randmt_t *generator, <span class="dt">unsigned</span> <span class="dt">long</span> seed)</a></code></pre></div>
<p>initializes <code>generator</code> with seed value <code>seed</code>.</p>
<h3 id="rand_unif_r">rand_unif_r</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb23-1" title="1"><span class="dt">double</span> rand_unif_r(randmt_t *generator)</a></code></pre></div>
<p>uses <code>generator</code> to generate a random number uniformly on the open interval (0,1) with 53-bit resolution.</p>
<h3 id="rand_uint32_r">rand_uint32_r</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb24-1" title="1"><span class="dt">unsigned</span> <span class="dt">long</span> rand_uint32_r(randmt_t *generator)</a></code></pre></div>
<p>uses <code>generator</code> to generate a random 32-bit unsigned integer uniformly between 0 and 2<sup>32</sup> − 1.</p>
<h3 id="rand_normal_r">rand_normal_r</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb25-1" title="1"><span class="dt">double</span> rand_normal_r(randmt_t *generator)</a></code></pre></div>
<p>uses <code>generator</code> to generate a standard normal distributed random number.</p>
<h3 id="rand_exp_r">rand_exp_r</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb26-1" title="1"><span class="dt">double</span> rand_exp(randmt_t *generator, <span class="dt">double</span> mu)</a></code></pre></div>
<p>uses <code>generator</code> to generate an exponentially-distributed number with mean <code>mu</code>.</p>
<h3 id="rand_gamma_r">rand_gamma_r</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb27-1" title="1"><span class="dt">double</span> rand_gamma(randmt_t *generator, <span class="dt">double</span> a, <span class="dt">double</span> b)</a></code></pre></div>
<p>uses <code>generator</code> to generate a Gamma-distributed number with shape parameter <code>a</code> and scale parameter <code>b</code>.</p>
<h3 id="rand_geometric_r">rand_geometric_r</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb28-1" title="1"><span class="dt">double</span> rand_geometric(randmt_t *generator, <span class="dt">double</span> p)</a></code></pre></div>
<p>uses <code>generator</code> to generate a geometrically-distributed number where <code>p</code> is the probability of success.</p>
<h3 id="rand_poisson_r">rand_poisson_r</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb29-1" title="1"><span class="dt">double</span> rand_poisson(randmt_t *generator, <span class="dt">double</span> mu)</a></code></pre></div>
<p>uses <code>generator</code> to generate a Poisson-distributed number with mean <code>mu</code>.</p>
<p><span class="copynote"> This material is based upon work supported by the National Science Foundation under Award No. DMS-1004694. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation. </span></p>
</div>

<div id="footer">
<p style="text-align:right">
<a href="https://scholar.google.com/citations?user=G8Yjd9AAAAAJ"  target="_blank">Google Scholar</a>
<a href="http://www.linkedin.com/in/pascalgetreuer" target="_blank">LinkedIn</a>
</p>
</div>
</body>
</html>
